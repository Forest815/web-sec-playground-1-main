# ğŸ” Web Security Playground - ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ 

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **Next.js** ã‚’ä½¿ç”¨ã—ãŸ **ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼ã‚·ã‚¹ãƒ†ãƒ ** ã®å®Ÿè£…ä¾‹ã§ã™ã€‚ã‚»ã‚­ãƒ¥ã‚¢ãªèªè¨¼ãƒ»èªå¯æ©Ÿèƒ½ã¨8ã¤ã®è¿½åŠ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã‚’å®Ÿè£…ã—ã¦ã„ã¾ã™ã€‚

![ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸](docs/main-page.svg)

## ğŸš€ å®Ÿè£…ã•ã‚ŒãŸæ©Ÿèƒ½

### ğŸ”‘ åŸºæœ¬èªè¨¼æ©Ÿèƒ½
- **ã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼**: HTTPOnlyã‚¯ãƒƒã‚­ãƒ¼ã‚’ä½¿ç”¨ã—ãŸã‚»ã‚­ãƒ¥ã‚¢ãªã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–**: bcryptã‚’ä½¿ç”¨ã—ãŸå¼·åŠ›ãªãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰æš—å·åŒ–ï¼ˆsaltRounds: 12ï¼‰
- **ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ãƒ»ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ**: å®Œå…¨ãªèªè¨¼ãƒ•ãƒ­ãƒ¼

### ğŸ›¡ï¸ è¿½åŠ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ï¼ˆ8ã¤å®Ÿè£…ï¼‰

#### 1. ğŸ”’ ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯æ©Ÿèƒ½
- **æ©Ÿèƒ½æ¦‚è¦**: é€£ç¶šã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã«å¤±æ•—ã™ã‚‹ã¨ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒä¸€æ™‚çš„ã«ãƒ­ãƒƒã‚¯ã•ã‚Œã‚‹
- **ä»•æ§˜**: 5å›é€£ç¶šå¤±æ•—ã§30åˆ†é–“ãƒ­ãƒƒã‚¯
- **å®Ÿè£…ç®‡æ‰€**: `src/app/api/login/route.ts`, `prisma/schema.prisma`

![ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ç”»é¢](docs/account-lock.svg)

#### 2. ğŸ’ª ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯
- **æ©Ÿèƒ½æ¦‚è¦**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®å¼·åº¦ã‚’5æ®µéšã§è©•ä¾¡
- **è©•ä¾¡é …ç›®**: é•·ã•ã€å¤§æ–‡å­—ãƒ»å°æ–‡å­—ã€æ•°å­—ã€ç‰¹æ®Šæ–‡å­—ã®ä½¿ç”¨
- **å®Ÿè£…ç®‡æ‰€**: `src/app/_utils/password.ts`, `src/app/signup/page.tsx`

![ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯](docs/password-strength.svg)

#### 3. ğŸ“§ ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹é‡è¤‡ç¢ºèª
- **æ©Ÿèƒ½æ¦‚è¦**: å…¥åŠ›æ™‚ã«ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§é‡è¤‡ã‚’ãƒã‚§ãƒƒã‚¯
- **UX**: é‡è¤‡ã—ã¦ã„ã‚‹å ´åˆã¯å³åº§ã«ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
- **å®Ÿè£…ç®‡æ‰€**: `src/app/api/check-email/route.ts`, `src/app/signup/page.tsx`

#### 4. ğŸ“Š ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´è¿½è·¡
- **æ©Ÿèƒ½æ¦‚è¦**: ãƒ¦ãƒ¼ã‚¶ãƒ¼ã®ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´ã‚’è¨˜éŒ²ãƒ»è¡¨ç¤º
- **è¨˜éŒ²é …ç›®**: IPã‚¢ãƒ‰ãƒ¬ã‚¹ã€ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã€ãƒ­ã‚°ã‚¤ãƒ³æ™‚åˆ»ã€æˆåŠŸ/å¤±æ•—
- **å®Ÿè£…ç®‡æ‰€**: `src/app/api/login-history/route.ts`, `src/app/member/about/page.tsx`

#### 5. âš¡ ãƒ¬ãƒ¼ãƒˆåˆ¶é™
- **æ©Ÿèƒ½æ¦‚è¦**: IPã‚¢ãƒ‰ãƒ¬ã‚¹å˜ä½ã§ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- **å®Ÿè£…ç®‡æ‰€**: `src/app/_utils/rateLimiter.ts`

#### 6. ğŸ”„ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆï¼ˆç§˜å¯†ã®è³ªå•ï¼‰
- **æ©Ÿèƒ½æ¦‚è¦**: ç§˜å¯†ã®è³ªå•ã¨ç­”ãˆã«ã‚ˆã‚‹ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
- **å®Ÿè£…ç®‡æ‰€**: `src/app/api/reset-password/route.ts`

#### 7. ğŸ’¾ ãƒ­ã‚°ã‚¤ãƒ³IDè¨˜æ†¶æ©Ÿèƒ½
- **æ©Ÿèƒ½æ¦‚è¦**: ãƒã‚§ãƒƒã‚¯ãƒœãƒƒã‚¯ã‚¹ã§ãƒ­ã‚°ã‚¤ãƒ³IDã‚’è¨˜æ†¶
- **å®Ÿè£…ç®‡æ‰€**: `src/app/login/page.tsx`

#### 8. ğŸ”§ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´æ©Ÿèƒ½
- **æ©Ÿèƒ½æ¦‚è¦**: ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
- **å®Ÿè£…ç®‡æ‰€**: `src/app/api/change-password/route.ts`

## âš ï¸ é‡è¦ãªæ³¨æ„äº‹é …

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯ **å­¦ç¿’ãƒ»æ¤œè¨¼ç›®çš„** ã§ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚

- ãƒ­ãƒ¼ã‚«ãƒ«ç’°å¢ƒï¼ˆlocalhostï¼‰ã§ã®ã¿å®Ÿè¡Œã—ã¦ãã ã•ã„
- å…¬é–‹ã‚µãƒ¼ãƒãƒ¼ã‚„ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆä¸Šã§ãƒ›ã‚¹ãƒˆã—ãªã„ã§ãã ã•ã„

## ğŸ“ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆæ§‹æˆ

```
src/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ _components/          # å†åˆ©ç”¨å¯èƒ½ãªUIã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ Button.tsx        # ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¿ãƒ³ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ
â”‚   â”‚   â”œâ”€â”€ ErrorMsgField.tsx # ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
â”‚   â”‚   â”œâ”€â”€ Header.tsx        # ãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ãƒ˜ãƒƒãƒ€ãƒ¼
â”‚   â”‚   â””â”€â”€ TextInputField.tsx # ãƒ†ã‚­ã‚¹ãƒˆå…¥åŠ›ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰
â”‚   â”œâ”€â”€ _contexts/            # React Context
â”‚   â”‚   â””â”€â”€ AuthContext.tsx   # èªè¨¼çŠ¶æ…‹ç®¡ç†
â”‚   â”œâ”€â”€ _hooks/               # ã‚«ã‚¹ã‚¿ãƒ ãƒ•ãƒƒã‚¯
â”‚   â”‚   â””â”€â”€ useAuth.ts        # èªè¨¼ãƒ•ãƒƒã‚¯
â”‚   â”œâ”€â”€ _types/               # TypeScriptå‹å®šç¾©
â”‚   â”œâ”€â”€ _utils/               # ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£é–¢æ•°
â”‚   â”‚   â”œâ”€â”€ password.ts       # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰é–¢é€£å‡¦ç†
â”‚   â”‚   â””â”€â”€ rateLimiter.ts    # ãƒ¬ãƒ¼ãƒˆåˆ¶é™å‡¦ç†
â”‚   â”œâ”€â”€ api/                  # API Routes
â”‚   â”‚   â”œâ”€â”€ auth/             # èªè¨¼çŠ¶æ…‹ç¢ºèª
â”‚   â”‚   â”œâ”€â”€ login/            # ãƒ­ã‚°ã‚¤ãƒ³å‡¦ç†
â”‚   â”‚   â”œâ”€â”€ logout/           # ãƒ­ã‚°ã‚¢ã‚¦ãƒˆå‡¦ç†
â”‚   â”‚   â”œâ”€â”€ check-email/      # ãƒ¡ãƒ¼ãƒ«é‡è¤‡ç¢ºèª
â”‚   â”‚   â”œâ”€â”€ login-history/    # ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´
â”‚   â”‚   â”œâ”€â”€ change-password/  # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´
â”‚   â”‚   â””â”€â”€ reset-password/   # ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆ
â”‚   â”œâ”€â”€ login/                # ãƒ­ã‚°ã‚¤ãƒ³ãƒšãƒ¼ã‚¸
â”‚   â”œâ”€â”€ signup/               # ç™»éŒ²ãƒšãƒ¼ã‚¸
â”‚   â””â”€â”€ member/               # èªè¨¼ãŒå¿…è¦ãªãƒšãƒ¼ã‚¸
â””â”€â”€ config/
    â””â”€â”€ auth.ts               # èªè¨¼è¨­å®š
```

## ğŸ› ï¸ æŠ€è¡“ã‚¹ã‚¿ãƒƒã‚¯ã¨å‰µæ„å·¥å¤«

### ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰
- **Next.js 15.4.3**: App Routerã‚’ä½¿ç”¨ã—ãŸãƒ¢ãƒ€ãƒ³ãªReactãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯
- **TypeScript**: å‹å®‰å…¨æ€§ã®ç¢ºä¿
- **TailwindCSS 4**: ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ãƒ•ã‚¡ãƒ¼ã‚¹ãƒˆã®CSSè¨­è¨ˆ
- **React Hook Form 7.56.3**: ãƒ•ã‚©ãƒ¼ãƒ ç®¡ç†ã¨ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- **SWR**: ãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒã¨ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°

### ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰
- **Prisma ORM 6.12.0**: å‹å®‰å…¨ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¢ã‚¯ã‚»ã‚¹
- **SQLite**: è»½é‡ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
- **bcryptjs 3.0.2**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–
- **Zod 3.24.4**: ã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### å‰µæ„å·¥å¤«ã—ãŸãƒã‚¤ãƒ³ãƒˆ

#### ğŸ¨ UXã®å‘ä¸Š
1. **ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³**: ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ã‚„ãƒ¡ãƒ¼ãƒ«é‡è¤‡ã‚’å³åº§ã«è¡¨ç¤º
2. **è¦–è¦šçš„ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯**: è‰²åˆ†ã‘ã•ã‚ŒãŸãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ã‚¤ãƒ³ã‚¸ã‚±ãƒ¼ã‚¿ãƒ¼
3. **ã‚¢ã‚¯ã‚»ã‚·ãƒ“ãƒªãƒ†ã‚£**: FontAwesome Iconsã‚’ä½¿ç”¨ã—ãŸç›´æ„Ÿçš„ãªUI
4. **ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–ãƒ‡ã‚¶ã‚¤ãƒ³**: TailwindCSSã«ã‚ˆã‚‹å®Œå…¨ãƒ¬ã‚¹ãƒãƒ³ã‚·ãƒ–å¯¾å¿œ

#### ğŸ”’ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã®å‘ä¸Š
1. **å¤šå±¤é˜²å¾¡**: è¤‡æ•°ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã‚’çµ„ã¿åˆã‚ã›
2. **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: HTTPOnlyã‚¯ãƒƒã‚­ãƒ¼ã«ã‚ˆã‚‹XSSæ”»æ’ƒå¯¾ç­–
3. **CSRFå¯¾ç­–**: SameSiteè¨­å®šã«ã‚ˆã‚‹ä¿è­·
4. **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: DDoSæ”»æ’ƒã‚„ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹æ”»æ’ƒã®é˜²æ­¢

#### âš¡ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æœ€é©åŒ–
1. **åŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿ãƒ•ã‚§ãƒƒãƒ**: SWRã«ã‚ˆã‚‹ã‚­ãƒ£ãƒƒã‚·ãƒ³ã‚°æˆ¦ç•¥
2. **å‹å®‰å…¨æ€§**: TypeScriptã¨Zodã«ã‚ˆã‚‹å …ç‰¢ãªå‹ã‚·ã‚¹ãƒ†ãƒ 
3. **è»½é‡ãªãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹**: SQLiteã«ã‚ˆã‚‹é«˜é€Ÿã‚¢ã‚¯ã‚»ã‚¹

## ğŸ”§ ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—æ‰‹é †

### 1. ãƒªãƒã‚¸ãƒˆãƒªã®ã‚¯ãƒ­ãƒ¼ãƒ³

```bash
git clone https://github.com/TakeshiWada1980/web-sec-playground-1.git
cd web-sec-playground-1
```

### 2. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

```bash
npm install
```

### 3. ç’°å¢ƒå¤‰æ•°ã®è¨­å®š

ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ«ãƒ¼ãƒˆã« `.env` ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ:

```env
DATABASE_URL="file:./app.db"
# JWT_SECRET ã¯å‰Šé™¤ã•ã‚Œã¾ã—ãŸï¼ˆã‚»ãƒƒã‚·ãƒ§ãƒ³ãƒ™ãƒ¼ã‚¹èªè¨¼ã®ãŸã‚ä¸è¦ï¼‰
```

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®åˆæœŸåŒ–

```bash
npx prisma db push
npx prisma generate
npx prisma db seed
```

### 5. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã®èµ·å‹•

```bash
npm run dev
```

ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯ `http://localhost:3000` ã§åˆ©ç”¨ã§ãã¾ã™ã€‚

### 6. ãƒ—ãƒ­ãƒ€ã‚¯ã‚·ãƒ§ãƒ³ãƒ“ãƒ«ãƒ‰

```bash
npm run build
npm run start
```

### 7. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ç®¡ç†

```bash
npx prisma studio
```

## ğŸ¯ ä¸»è¦æ©Ÿèƒ½ã®å‹•ä½œç¢ºèª

### 1. ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²
1. `http://localhost:3000/signup` ã«ã‚¢ã‚¯ã‚»ã‚¹
2. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãŒãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è¡¨ç¤ºã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª
3. ãƒ¡ãƒ¼ãƒ«ã‚¢ãƒ‰ãƒ¬ã‚¹é‡è¤‡ãƒã‚§ãƒƒã‚¯ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

### 2. ãƒ­ã‚°ã‚¤ãƒ³ãƒ»ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ
1. `http://localhost:3000/login` ã«ã‚¢ã‚¯ã‚»ã‚¹
2. æ­£ã—ã„èªè¨¼æƒ…å ±ã§ãƒ­ã‚°ã‚¤ãƒ³
3. ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã‚’5å›ç¹°ã‚Šè¿”ã—ã¦ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯ã‚’ç¢ºèª

### 3. èªè¨¼å¾Œæ©Ÿèƒ½
1. `http://localhost:3000/member` ã§ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´ã‚’ç¢ºèª
2. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¤‰æ›´æ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ
3. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒªã‚»ãƒƒãƒˆæ©Ÿèƒ½ã‚’ãƒ†ã‚¹ãƒˆ

## ğŸ§ª å®Ÿè£…ã®è©³ç´°è§£èª¬

### ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†ã®å®Ÿè£…

```typescript
// src/config/auth.ts
export const sessionOptions: IronSessionOptions = {
  password: process.env.SESSION_SECRET!,
  cookieName: 'session',
  cookieOptions: {
    httpOnly: true,
    secure: process.env.NODE_ENV === 'production',
    sameSite: 'strict',
    maxAge: 30 * 24 * 60 * 60, // 30æ—¥
  },
};
```

### ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦è©•ä¾¡ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ 

```typescript
// src/app/_utils/password.ts
export const getPasswordStrength = (password: string) => {
  let score = 0;
  const feedback: string[] = [];

  // 5ã¤ã®è©•ä¾¡é …ç›®ã§å¼·åº¦ã‚’åˆ¤å®š
  if (password.length >= 8) score += 1;
  if (/[A-Z]/.test(password)) score += 1;
  if (/[a-z]/.test(password)) score += 1;
  if (/[0-9]/.test(password)) score += 1;
  if (/[^A-Za-z0-9]/.test(password)) score += 1;

  return { score, feedback, level: getStrengthLevel(score) };
};
```

### ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯æ©Ÿèƒ½

```typescript
// src/app/api/login/route.ts
if (user.failedLoginAttempts >= 5) {
  const lockTime = new Date(user.lockedUntil!);
  if (lockTime > new Date()) {
    return NextResponse.json(
      { success: false, message: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™' },
      { status: 423 }
    );
  }
}
```

## ğŸ“Š ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¹ã‚­ãƒ¼ãƒ

```prisma
model User {
  id                   String         @id @default(cuid())
  email                String         @unique
  hashedPassword       String
  name                 String
  isLocked             Boolean        @default(false)
  failedLoginAttempts  Int            @default(0)
  lockedUntil          DateTime?
  secretQuestion       String
  secretAnswer         String
  createdAt            DateTime       @default(now())
  updatedAt            DateTime       @updatedAt
  sessions             Session[]
  loginHistory         LoginHistory[]
}

model Session {
  id        String   @id @default(cuid())
  userId    String
  sessionId String   @unique
  createdAt DateTime @default(now())
  expiresAt DateTime
  user      User     @relation(fields: [userId], references: [id], onDelete: Cascade)
}

model LoginHistory {
  id          String    @id @default(cuid())
  userId      String
  ipAddress   String
  userAgent   String
  success     Boolean
  attemptedAt DateTime  @default(now())
  user        User      @relation(fields: [userId], references: [id], onDelete: Cascade)
}
```

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

### å®Ÿè£…æ¸ˆã¿ã®å¯¾ç­–
- âœ… **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ãƒãƒƒã‚·ãƒ¥åŒ–**: bcryptï¼ˆsaltRounds: 12ï¼‰
- âœ… **ã‚»ãƒƒã‚·ãƒ§ãƒ³ç®¡ç†**: HTTPOnlyã‚¯ãƒƒã‚­ãƒ¼
- âœ… **CSRFå¯¾ç­–**: SameSiteè¨­å®š
- âœ… **XSSå¯¾ç­–**: HTTPOnlyã‚¯ãƒƒã‚­ãƒ¼ä½¿ç”¨
- âœ… **ãƒ–ãƒ«ãƒ¼ãƒˆãƒ•ã‚©ãƒ¼ã‚¹å¯¾ç­–**: ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯æ©Ÿèƒ½
- âœ… **ãƒ¬ãƒ¼ãƒˆåˆ¶é™**: IPå˜ä½ã§ã®ã‚¢ã‚¯ã‚»ã‚¹åˆ¶é™
- âœ… **å…¥åŠ›æ¤œè¨¼**: Zodã‚¹ã‚­ãƒ¼ãƒãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³

### ä»Šå¾Œã®æ”¹å–„ç‚¹
- [ ] **2è¦ç´ èªè¨¼**: TOTP/SMSèªè¨¼ã®è¿½åŠ 
- [ ] **OAuthé€£æº**: Google/GitHubèªè¨¼
- [ ] **ãƒ­ã‚°ç›£æŸ»**: ã‚ˆã‚Šè©³ç´°ãªã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒ­ã‚°
- [ ] **æš—å·åŒ–**: ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹æš—å·åŒ–

## ğŸ“ˆ ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹æŒ‡æ¨™

- **åˆæœŸãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿**: < 2ç§’
- **èªè¨¼å‡¦ç†**: < 500ms
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ï¼ˆ< 100msï¼‰
- **ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã‚¯ã‚¨ãƒª**: å¹³å‡ < 50ms

## ğŸ¤ è²¢çŒ®æ–¹æ³•

1. ã“ã®ãƒªãƒã‚¸ãƒˆãƒªã‚’ãƒ•ã‚©ãƒ¼ã‚¯
2. æ©Ÿèƒ½ãƒ–ãƒ©ãƒ³ãƒã‚’ä½œæˆ (`git checkout -b feature/amazing-feature`)
3. å¤‰æ›´ã‚’ã‚³ãƒŸãƒƒãƒˆ (`git commit -m 'Add amazing feature'`)
4. ãƒ–ãƒ©ãƒ³ãƒã«ãƒ—ãƒƒã‚·ãƒ¥ (`git push origin feature/amazing-feature`)
5. ãƒ—ãƒ«ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’ä½œæˆ

## ğŸ“ ãƒ©ã‚¤ã‚»ãƒ³ã‚¹

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¯å­¦ç¿’ç›®çš„ã§ä½œæˆã•ã‚Œã¦ãŠã‚Šã€MITãƒ©ã‚¤ã‚»ãƒ³ã‚¹ã®ä¸‹ã§å…¬é–‹ã•ã‚Œã¦ã„ã¾ã™ã€‚

## ğŸ‘¨â€ğŸ’» ä½œæˆè€…

**[Your Name]**
- å­¦ç¿’ç›®çš„ã§ã‚»ã‚­ãƒ¥ã‚¢ãªèªè¨¼ã‚·ã‚¹ãƒ†ãƒ ã‚’å®Ÿè£…
- 8ã¤ã®è¿½åŠ ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£æ©Ÿèƒ½ã‚’å‰µæ„å·¥å¤«ã—ã¦é–‹ç™º

---

**âš ï¸ æ³¨æ„**: ã“ã®ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã¯å­¦ç¿’ãƒ»æ¤œè¨¼ç›®çš„ã§ä½œæˆã•ã‚Œã¦ã„ã¾ã™ã€‚æœ¬ç•ªç’°å¢ƒã§ã®ä½¿ç”¨ã¯æ¨å¥¨ã•ã‚Œã¾ã›ã‚“ã€‚

---

## ğŸ“¸ ç”»åƒã«ã¤ã„ã¦

README.mdã«å«ã¾ã‚Œã‚‹ç”»åƒã¯ä»¥ä¸‹ã®æ‰‹é †ã§æ’®å½±ã—ã¦ãã ã•ã„ï¼š

### ğŸ“ ç”»åƒãŒè¡¨ç¤ºã•ã‚Œãªã„å ´åˆ

ç¾åœ¨ã€ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ãŒå­˜åœ¨ã—ãªã„ãŸã‚è¡¨ç¤ºã•ã‚Œã¾ã›ã‚“ã€‚ä»¥ä¸‹ã®æ‰‹é †ã§ç”»åƒã‚’è¿½åŠ ã—ã¦ãã ã•ã„ï¼š

### å¿…è¦ãªç”»åƒï¼ˆ3æšä»¥ä¸Šï¼‰

1. **ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸** (`docs/main-page.png`)
   - URL: `http://localhost:3000`
   - ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã®ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

2. **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯** (`docs/password-strength.png`)
   - URL: `http://localhost:3000/signup`
   - ãƒ¦ãƒ¼ã‚¶ãƒ¼ç™»éŒ²ç”»é¢ã§ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦è¡¨ç¤ºãŒå‹•ä½œã—ã¦ã„ã‚‹çŠ¶æ…‹

3. **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯æ©Ÿèƒ½** (`docs/account-lock.png`)
   - URL: `http://localhost:3000/login`
   - ãƒ­ã‚°ã‚¤ãƒ³å¤±æ•—ã‚’5å›ç¹°ã‚Šè¿”ã—ãŸå¾Œã®ã‚¨ãƒ©ãƒ¼ç”»é¢

4. **ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´è¡¨ç¤º** (`docs/login-history.png`) *[ã‚ªãƒ—ã‚·ãƒ§ãƒ³]*
   - URL: `http://localhost:3000/member/about`
   - ãƒ­ã‚°ã‚¤ãƒ³å¾Œã®ãƒ¡ãƒ³ãƒãƒ¼ãƒšãƒ¼ã‚¸ã§ãƒ­ã‚°ã‚¤ãƒ³å±¥æ­´ãŒè¡¨ç¤ºã•ã‚ŒãŸçŠ¶æ…‹

### ğŸ“¸ æ’®å½±æ‰‹é †

1. é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•: `npm run dev`
2. ãƒ–ãƒ©ã‚¦ã‚¶ã§å„URLã«ã‚¢ã‚¯ã‚»ã‚¹
3. ç”»é¢è§£åƒåº¦ã‚’1200x800pxç¨‹åº¦ã«èª¿æ•´ã—ã¦ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆæ’®å½±
4. æ’®å½±ã—ãŸç”»åƒã‚’ `docs/` ãƒ•ã‚©ãƒ«ãƒ€ã«é…ç½®

è©³ç´°ãªæ’®å½±ã‚¬ã‚¤ãƒ‰ã¯ `docs/screenshot-guide.md` ã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚

### ğŸ¨ ç”»åƒã®ä»£ã‚ã‚Šã«æ©Ÿèƒ½èª¬æ˜

ç”»åƒã‚’è¿½åŠ ã™ã‚‹ã¾ã§ã€ä»¥ä¸‹ã®ãƒ†ã‚­ã‚¹ãƒˆã§å„æ©Ÿèƒ½ã‚’ç†è§£ã§ãã¾ã™ï¼š

- **ãƒ¡ã‚¤ãƒ³ãƒšãƒ¼ã‚¸**: ã‚·ãƒ³ãƒ—ãƒ«ãªãƒŠãƒ“ã‚²ãƒ¼ã‚·ãƒ§ãƒ³ã¨èªè¨¼æ©Ÿèƒ½ã¸ã®ãƒªãƒ³ã‚¯
- **ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å¼·åº¦ãƒã‚§ãƒƒã‚¯**: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§è‰²åˆ†ã‘ã•ã‚ŒãŸ5æ®µéšã®å¼·åº¦è¡¨ç¤º
- **ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãƒ­ãƒƒã‚¯**: ã€Œã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒãƒ­ãƒƒã‚¯ã•ã‚Œã¦ã„ã¾ã™ã€‚30åˆ†å¾Œã«å†è©¦è¡Œã—ã¦ãã ã•ã„ã€ã®ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸